\documentclass[12pt, leqno, british]{amsart}
\input{../preamble}
\addbibresource{../bibliography.bib}
\externaldocument[M-]{../Lecture-notes}

\author{Nicolas Daans}
\address{Charles University, Faculty of Mathematics and Physics, Department of Algebra, Sokolov\-sk\' a 83, 18600 Praha~8, Czech Republic.}
\email{nicolas.daans@matfyz.cuni.cz}

\begin{document}

\section{Lecture 9}

\subsection{Hilbert's Reciprocity Law}
We now start our way towards a classification of quadratic forms over $\qq$.
As discussed in the previous lecture, given a quadratic form over $\qq$, we can consider the scalar extension to $\rr$ or $\qq_p$, and the goal is to understand quadratic forms over $\qq$ via its scalar extensions to $\rr$ and $\qq_p$ for different primes $p$.

The first result is called Hilbert's Reciprocity Law\index{reciprocity law!Hilbert's}, and is a consequence of the Quadratic Reciprocity Law\index{reciprocity law!quadratic}.
Let us first recall the Quadratic Reciprocity Law; see any book or course on elementary number theory for a proof.
\begin{thm}[Quadratic Reciprocity]\label{T:QuadraticReciprocity}
Let $p, q \in \mbb P \setminus \lbrace 2 \rbrace$ be such that $p \neq q$.
\begin{itemize}
\item $-1$ is a square in $\ff_p$ if and only if $p \equiv 1 \bmod 4$,
\item $2$ is a square in $\ff_p$ if and only if $p \equiv \pm 1 \bmod 8$,
\item $p$ is a square in $\ff_q$ if and only if
\begin{itemize}
\item $p \equiv 1 \bmod 4$ and $q$ is a square in $\ff_p$, or
\item $q \equiv 1 \bmod 4$ and $q$ is a square in $\ff_p$, or
\item $p \equiv q \equiv 3 \bmod 4$ and $q$ is not a square in $\ff_p$.
\end{itemize}
\end{itemize}
\end{thm}
\begin{lem}\label{L:I2/I3R}
$\llangle -1, -1 \rrangle_{\rr}$ is the unique anisotropic quadratic form over $\rr$ up to isometry.
For any $x, y \in \rr^\times$, we have $\lbrace x, y \rbrace_{\rr} = 0$ if and only if $x > 0$ or $y > 
0$.
In particular, $I\rr/I^2\rr \cong \zz/2\zz$.
\end{lem}
\begin{proof}
Exercise.
\end{proof}
To state Hilbert's Reciprocity Law, it will be convenient to set $\qq_{\infty} = \rr$ and $\mbb P' = \mbb P \cup \lbrace \infty \rbrace$.
\begin{thm}[Hilbert's Reciprocity Law]\label{T:HilbertReciprocity}
Let $x, y \in \qq^\times$.
The set
$$ S = \lbrace p \in \mbb P' \mid \lbrace x, y \rbrace_{\qq_p} \neq 0 \rbrace$$
contains a finite, even number of elements.
\end{thm}
\begin{proof}
For all but finitely many $p \in \mbb P \setminus \lbrace 2 \rbrace$, $v_p(x) = v_p(y) = 0$ (see \Cref{M-P:p-adic-valuation}).
By \Cref{M-P:2-fold-Pfister-qqp-odd} we thus obtain $\lbrace x, y \rbrace_{\qq_p} = 0$ for all but these finitely many odd prime numbers.
This shows that this set $S$ is always finite.

Now consider the map
\begin{displaymath}
\oplus : I^2\qq /I^3\qq \to \bigoplus_{p \in \mbb P'} I^2\qq_p/I^3\qq_p : [q] \mapsto \oplus_{p \in \mbb P'} [q_{\qq_p}].
\end{displaymath}
By the observation from the previous paragraph: any symbol $\lbrace x, y \rbrace_{\qq}$ becomes $0$ when extending scalars to all but finitely many $\qq_p$, so this map is well-defined.
In fact, since each of the individual maps $[q] \mapsto [q_{\qq_p}]$ is a group homomorphism by \Cref{M-P:restriction-homomorphism}, also the map $\oplus$ is a group homomorphism.

Now consider the map
\begin{displaymath}
\Sigma : \bigoplus_{p \in \mbb P'} I^2\qq_p/I^3\qq_p \to \zz/2\zz : \oplus_{p \in \mbb P'} [q_p] \mapsto \sum_{p \in \mbb P'} \delta_{[q_p]}
\end{displaymath}
where $\delta_{[q_p]} = 0$ if $[q_p] = 0$ and otherwise $\delta_{[q_p]} = 1$.
This is a well-defined map, and since $I^2\qq_p/I^3\qq_p \cong \zz/2\zz$ for all $p \in \mbb P'$ by \Cref{M-C:unique-2-fold-Pfister-qqp-odd}, \Cref{M-P:2-fold-Pfister-qq2}, and \Cref{L:I2/I3R}, it is actually a group homomorphism.

We now make the following observation: to show the theorem is to show that the map $\Sigma \circ \oplus = 0$; in other words, the image of $\circ$ is contained in the kernel of $\Sigma$.
Since $\Sigma \circ \oplus$ is a group homomorphism, it suffices to show that $\Sigma \circ \oplus$ is zero on a set of generators of $I^2\qq/I^3\qq$.

$I^2\qq_p/I^3\qq_p$ is generated by symbols $\lbrace x, y \rbrace_{\qq}$ for $x, y \in \qq^\times$.
By the computation rules for symbols (\Cref{M-C:K-theory-axioms}) we may assume that $x, y \in \zz$.
In fact, using bilinearity (\Cref{M-P:K-theory-axioms}) and the fact that every integer is a product of prime numbers and $\pm 1$, we have reduced to showing the theorem in the following cases:
\begin{itemize}
\item $x = y = -1$,
\item $x = -1$, $y = 2$,
\item $x = y = 2$,
\item $x = -1$, $y = p$ for some $p \in \mbb P \setminus \lbrace 2 \rbrace$,
\item $x = 2$, $y = p$ for some $p \in \mbb P \setminus \lbrace 2 \rbrace$,
\item $x = y = p$ for some $p \in \mbb P \setminus \lbrace 2 \rbrace$,
\item $x = p$ and $y = q$ for some distinct primes $p, q \in \mbb P \setminus \lbrace 2 \rbrace$.
\end{itemize}
Each of these cases can now be checked by hand, using \Cref{T:QuadraticReciprocity} and the computation rules for $\lbrace x, y \rbrace_{\qq_p}$ (\Cref{M-P:2-fold-Pfister-qqp-odd}, \Cref{M-P:2-fold-Pfister-qq2}, \Cref{L:I2/I3R}).
Let us consider the last of them and leave the others as an exercise.

So suppose $p, q \in \mbb P \setminus \lbrace 2 \rbrace$ and let $S = \lbrace p' \in \mbb P' \mid \lbrace p, q \rbrace_{\qq_{p'}} \neq 0 \rbrace$.
By \Cref{M-P:2-fold-Pfister-qqp-odd} $r \not\in S$ for any $r \in \mbb P \setminus \lbrace 2,p,q\rbrace$.
By \Cref{M-P:2-fold-Pfister-qq2} we have that $\infty \not\in S$.
By \Cref{M-P:2-fold-Pfister-qq2} we have $2 \in S$ if and only if $p, q \equiv 3 \bmod 4$.
Furthermore, we compute using \Cref{M-P:2-fold-Pfister-qqp-odd} and \Cref{T:QuadraticReciprocity} that
\begin{align*}
p \in S &\Leftrightarrow q \text{ is not a square in } \ff_p \\
&\Leftrightarrow \begin{cases}
p \text{ is a square in } \ff_q &\text{if } p \equiv q \equiv 3 \bmod 4 \\
p \text{ is not a square in } \ff_q &\text{otherwise}
\end{cases} \\
&\Leftrightarrow \begin{cases}
q \not\in S &\text{if } p \equiv q \equiv 3 \bmod 4 \\
q \in S &\text{otherwise}
\end{cases}.
\end{align*}
From this we conclude that $\lvert S \rvert \in \lbrace 0, 2 \rbrace$, and thus in particular $S$ contains an even number of elements, as desired.
\end{proof}

\subsection{Approximation}
Recall from elementary number theory the Chinese Remainder Theorem:
\begin{thm}\label{T:CRT}
Let $S \subseteq \mbb P$ be a set of prime numbers and $n \in \nat$.
For each $p \in S$, let $a_p \in \zz$.
Then there exists $a \in \zz$ such that $a \equiv a_p \bmod p^n$ for all $p \in S$.
\end{thm}
This theorem has the following reformulation in the language of $p$-adic numbers.
\begin{cor}\label{C:CRT}
Let $S \subseteq \mbb P$ be a set of prime numbers and $n \in \nat$.
For each $p \in S$, let $x_p \in \zz_p$.
Then there exists $x \in \zz$ such that $v_p(x - x_p) > n$ for all $p \in S$.
\end{cor}
\begin{proof}
Exercise.
\end{proof}
In other words, we know that (by construction) we can for each $p \in \mbb P$ approximate $p$-adic integers arbitrarily closely by rational integers, but in fact, one can do so for a finite set of prime numbers simultaneously.
We now prove the following variation for rational numbers.
\begin{thm}[Artin Approximation]\label{T:WAT}
Let $S \subseteq \mbb P$ be finite and fix $q \in \mbb P \setminus S$.
Let $n \in \nat$, and for each $p \in S$, fix $x_p \in \qq_p$, and also fix $x_\infty \in \rr$.
Then there exists $x \in \qq$ such that
\begin{itemize}
\item for all $p \in S$, one has $v_p(x - x_p) > n$,
\item $\lvert x - x_\infty \rvert < 1/n$,
\item for all $r \in \mbb P \setminus (S \cup \lbrace q \rbrace)$ we have $x \in \zz_r$.
In other words, the denominator of $x$ is not divisible by and primes outside of $S \cup \lbrace q \rbrace$.
\end{itemize} 
\end{thm}
\begin{proof}
We may replace the number $n$ in the statement by a larger natural number, as that will only strengthen the outcome.
In particular, we may assume without loss of generality $n \geq -v_p(x_p)$ for all $p \in S$.
Furthermore, since we can arbitarily approximate an element in $\qq_p$ by an element of $\qq$ with denominator a power of $p$, we may also assume that $x_p \in \qq$ with denominator a power of $p$.
Similarly, by increasing $n$ if needed, we may assume that $x_\infty \in \qq$ with denominator a power of $q$.

For each $p \in S$, we shall show the existence of an element $d_p \in \qq$ whose denominator is a power of $q$ and such that
\begin{displaymath}
v_p(d_p-1) > 2n, \quad v_{p'}(d_p) > 2n \text{ for all } p' \in S \setminus \lbrace p \rbrace, \text{ and}\quad \lvert d_p \rvert < \frac{1}{n(\lvert S \rvert + 1) \lvert x_p \rvert},
\end{displaymath}
and furthermore an element $d_\infty \in \qq$ whose denominator is a power of $q$ and such that
\begin{displaymath}
v_p(d_\infty) > 2n \text{ for all } p \in S, \text{ and}\qquad \lvert d_\infty - 1 \rvert < \frac{1}{n(\lvert S \rvert + 1)\lvert x_\infty \rvert}.
\end{displaymath}
Once we have found these elements, we will be almost done: it suffices to set $x = \sum_{p \in S} x_pd_p + x_\infty d_\infty$.
We then compute that, for $p \in \mbb P$,
\begin{align*}
v_p(x - x_p) &= v_p(x - x_pd_p + x_pd_p - x_p) \geq \min \lbrace v_p(x - x_pd_p), v_p(x_pd_p - x_p) \rbrace \\
&= \min \lbrace v_p(\sum_{p' \in (S \cup \lbrace \infty \rbrace) \setminus \lbrace p \rbrace} x_{p'}d_{p'}), v_p(x_p) + v_p(d_p - 1) \rbrace \\
&\geq \min \lbrace \min_{p' \in (S \cup \lbrace \infty \rbrace) \setminus \lbrace p \rbrace} \lbrace v_p(x_{p'}) + v_p(d_{p'}) \rbrace, v_p(x_p) + v_p(d_p - 1) \rbrace > n
\end{align*}
by construction of the $d_p$'s, and similarly
\begin{align*}
\lvert x - x_\infty \rvert &\leq \lvert x - x_\infty d_\infty \rvert + \lvert x_\infty d_\infty - x_\infty \rvert \\
&\leq \sum_{p \in S} \lvert x_p \rvert \lvert d_p \rvert + \lvert x_\infty \rvert \lvert d_\infty - 1 \rvert < \frac{1}{n}.
\end{align*}
Thus, it now remains to show that such $d_p$ can be constructed for each $p \in S \cup \lbrace \infty \rbrace$ individually.

Consider first $p \in S$.
Since the multiplicative group $(\zz/p^{2n}\zz)^\times$ is finite, and $\prod_{p' \in S \setminus \lbrace p \rbrace} p'$ represents an invertible element in $\zz/p^{2n}\zz$, there exists $N > 2n$ such that $(\prod_{p' \in S \setminus \lbrace p \rbrace} p')^N \equiv 1 \bmod p^{2n}$.
Similarly, since $q$ represents an invertible element in $\zz/p^{2n}\zz$, there exist arbitrarily large $M \in \nat$ with $q^M \equiv 1 \bmod p^{2n}$.
In particular, we can take $M$ large enough so that $\lvert (\prod_{p' \in S \setminus \lbrace p \rbrace} p')^N q^{-M} \rvert < (n(\lvert S \rvert + 1)\lvert x_\infty \rvert)^{-1}$.
Now $d_p = (\prod_{p' \in S \setminus \lbrace p \rbrace} p')^N q^{-M}$ is as desired.

Finally, again by similar arguments, we may choose $M \in \nat$ large enough such that $q^{M} \equiv 1 \bmod p^{2n}$ for all $p \in S$, at the same time $\lvert q^{-M} \rvert \leq (n(\lvert S \rvert + 1) \lvert x_\infty \rvert)^{-1}$.
Then $d_\infty = 1 - q^{-M}$ is as desired.
\end{proof}
We will need later also the following strengthening of \Cref{T:CRT}, often referred to as Dirichlet's Theorem on (Primes in) Arithmetic Progressions.
\begin{thm}[Dirichlet's Theorem]\label{T:Dirichlet}
Let $m, n \in \nat$ be coprime.
There exist infinitely many $p \in \mbb P$ with $p \equiv n \bmod m$.
\end{thm}
\begin{proof}
See for example \cite[Section I.10, Exercise 1]{Neu99}.
\end{proof}
Note that in the above theorem, we may replace one congruence condition with finitely many, as long as they pertain to coprime moduli, in view of \Cref{T:CRT}.

\subsection{Exercises}
\begin{enumerate}
\item Give a proof of \Cref{L:I2/I3R}.
\item Consider $\qq_p$ with the $p$-adic topology, $\qq_{\infty} = \rr$ with the euclidean topology, and consider $\prod_{p \in \mbb P'} \qq_p$ with the induced product topology.
Show that the image of the diagonal embedding
$$ \qq \to \prod_{p \in \mbb P'} \qq_p : x \mapsto (x)_{p \in \mbb P'} $$
is dense with respect to the product topology.
\item Use \Cref{T:Dirichlet} to show a converse to \Cref{T:HilbertReciprocity}: for every finite set $S \subseteq \mbb P'$ of even cardinality, there exist $x, y \in \qq^\times$ such that $S = \lbrace p \in \mbb P' \mid \lbrace x, y \rbrace_{\qq_p} \neq 0 \rbrace$.
\item\label{ex:solution-modulo-m} Use Exercise \eqref{M-ex:solution-patching} from Lecture 6 to show that the following are equivalent for $n \in \nat$ and $f \in \zz[X_1, \ldots, X_n]$:
\begin{itemize}
\item $f$ has a zero in $\zz/m\zz$ for all $m \in \nat$,
\item $f$ has a zero in $\zz_p$ for all $p \in \mbb P$.
\end{itemize}
\item Show that the polynomial $f(X) = (X^2 - 13)(X^2 - 17)(X^2 - 221)$ has no zero in $\zz$, but has a zero in $\rr$ and in $\zz/m\zz$ for every $m \in \nat$.
\end{enumerate}

\end{document}